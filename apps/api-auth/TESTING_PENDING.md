# üìã –ù–µ–ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø—É–Ω–∫—Ç—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

**–î–∞—Ç–∞:** 2025-11-17
**–í–µ—Ä—Å–∏—è:** 1.0

---

## üîç –ü—É–Ω–∫—Ç—ã, —Ç—Ä–µ–±—É—é—â–∏–µ –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–≥–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### JWT —Ç–æ–∫–µ–Ω—ã
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç replay-–∞—Ç–∞–∫ (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –º–µ—Ö–∞–Ω–∏–∑–º–∞ blacklist)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–ª–≥–æ—Ä–∏—Ç–º–∞ –ø–æ–¥–ø–∏—Å–∏ (HS256 vs RS256) - —Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞

### –ü–∞—Ä–æ–ª–∏
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks –ø—Ä–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏–∏ –ø–∞—Ä–æ–ª–µ–π (bcrypt –¥–æ–ª–∂–µ–Ω –∑–∞—â–∏—â–∞—Ç—å, –Ω–æ —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏)
- [ ] –ü–æ–ª–∏—Ç–∏–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ –ø–∞—Ä–æ–ª–µ–π (–Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞, —Ç—Ä–µ–±—É–µ—Ç —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏)

### OAuth2
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ state –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ OAuth2 flow)
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç CSRF –≤ OAuth2 flow (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞)

### 2FA
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç brute force –Ω–∞ 2FA (—Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–æ–ø—ã—Ç–∫–∞–º–∏)

### Timing Attacks
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç timing attacks –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ç–æ–∫–µ–Ω–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏)

### –í–∞–ª–∏–¥–∞—Ü–∏—è
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞—â–∏—Ç—ã –æ—Ç command injection (—Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ exec/shell commands)

### –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö
- [ ] –ü—Ä–æ–≤–µ—Ä–∫–∞ —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –≤ –ë–î (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ PostgreSQL)

### –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- [ ] –†–æ—Ç–∞—Ü–∏—è —Å–µ–∫—Ä–µ—Ç–æ–≤ (—Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å–∞/–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏)

---

## üß™ –ú–µ—Ç–æ–¥—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è –Ω–µ–ø—Ä–æ–≤–µ—Ä–µ–Ω–Ω—ã—Ö –ø—É–Ω–∫—Ç–æ–≤

### 1. JWT Replay Attack
**–ú–µ—Ç–æ–¥:**
- –ü–æ–ª—É—á–∏—Ç—å —Ç–æ–∫–µ–Ω
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Ç–æ–∫–µ–Ω –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ä–∞–∑
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ª–∏ –ø–æ–≤—Ç–æ—Ä–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ blacklist

**–ö–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```typescript
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å RefreshTokenBlacklistService
// –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –º–µ—Ö–∞–Ω–∏–∑–º –∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏–∏ —Ç–æ–∫–µ–Ω–æ–≤ –ø—Ä–∏ logout
```

### 2. JWT Algorithm
**–ú–µ—Ç–æ–¥:**
- –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å JWT header
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∞–ª–≥–æ—Ä–∏—Ç–º –ø–æ–¥–ø–∏—Å–∏ (alg –≤ header)
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è HS256 –∏–ª–∏ RS256, –∞ –Ω–µ "none"

**–ö–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –î–µ–∫–æ–¥–∏—Ä–æ–≤–∞—Ç—å header JWT —Ç–æ–∫–µ–Ω–∞
echo $TOKEN | cut -d'.' -f1 | base64 -d | jq '.'
```

### 3. Timing Attacks
**–ú–µ—Ç–æ–¥:**
- –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –¥–ª—è –≤–∞–ª–∏–¥–Ω—ã—Ö –∏ –Ω–µ–≤–∞–ª–∏–¥–Ω—ã—Ö –ø–∞—Ä–æ–ª–µ–π/—Ç–æ–∫–µ–Ω–æ–≤
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Ä–µ–º—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ–µ (bcrypt –¥–æ–ª–∂–µ–Ω –∑–∞—â–∏—â–∞—Ç—å)

**–ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã:**
- `time curl` –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
- –ê–Ω–∞–ª–∏–∑ –∫–æ–¥–∞ –Ω–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ timing-safe —Å—Ä–∞–≤–Ω–µ–Ω–∏—è

### 4. OAuth2 State Parameter
**–ú–µ—Ç–æ–¥:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–¥ OAuth2 –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–∞
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ state –ø–∞—Ä–∞–º–µ—Ç—Ä –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∑–∞—â–∏—Ç—É –æ—Ç CSRF

**–§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- `apps/api-auth/src/auth/oauth2/controllers/oauth2.controller.ts`
- `libs/domain/auth/src/oauth2/services/oauth2.service.ts`

### 5. 2FA Brute Force
**–ú–µ—Ç–æ–¥:**
- –û—Ç–ø—Ä–∞–≤–∏—Ç—å –º–Ω–æ–∂–µ—Å—Ç–≤–æ –Ω–µ–≤–µ—Ä–Ω—ã—Ö TOTP –∫–æ–¥–æ–≤
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è –ª–∏ –ø–æ—Å–ª–µ N –ø–æ–ø—ã—Ç–æ–∫
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å rate limiting –¥–ª—è 2FA —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤

**–ö–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
```bash
# –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ —Å –Ω–µ–≤–µ—Ä–Ω—ã–º–∏ –∫–æ–¥–∞–º–∏
for i in {1..20}; do
  curl -X POST /auth/2fa/verify -d '{"code":"000000"}'
done
```

### 6. Command Injection
**–ú–µ—Ç–æ–¥:**
- –ü–æ–∏—Å–∫ –≤ –∫–æ–¥–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `exec`, `spawn`, `shell`, `system`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –º–µ—Å—Ç, –≥–¥–µ –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –≤–Ω–µ—à–Ω–∏–µ –∫–æ–º–∞–Ω–¥—ã
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —Å–∞–Ω–∏—Ç–∏–∑–∏—Ä—É—é—Ç—Å—è

**–ö–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø–æ–∏—Å–∫–∞:**
```bash
grep -r "exec\|spawn\|shell\|system" apps/api-auth/src
```

### 7. Database Encryption
**–ú–µ—Ç–æ–¥:**
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é PostgreSQL
- –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ —á—É–≤—Å—Ç–≤–∏—Ç–µ–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ —à–∏—Ñ—Ä—É—é—Ç—Å—è
- –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ TDE (Transparent Data Encryption)

**–§–∞–π–ª—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏:**
- `apps/api-auth/prisma/schema.prisma`
- –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è PostgreSQL

---

## üìù –ü–ª–∞–Ω —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 1 (High)
1. ‚úÖ Email enumeration - **–ù–ê–ô–î–ï–ù–û** (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
2. ‚úÖ Email injection - **–ù–ê–ô–î–ï–ù–û** (—Ç—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è)
3. ‚úÖ npm audit - **–í–´–ü–û–õ–ù–ï–ù–û** (–Ω–∞–π–¥–µ–Ω—ã —É—è–∑–≤–∏–º–æ—Å—Ç–∏)

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 2 (Medium)
1. JWT replay attack - —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ blacklist –º–µ—Ö–∞–Ω–∏–∑–º–∞
2. OAuth2 state validation - —Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞
3. 2FA brute force - —Ç—Ä–µ–±—É–µ—Ç —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç 3 (Low)
1. Timing attacks - —Ç—Ä–µ–±—É–µ—Ç –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞
2. Command injection - —Ç—Ä–µ–±—É–µ—Ç –∞–Ω–∞–ª–∏–∑–∞ –∫–æ–¥–∞
3. Database encryption - —Ç—Ä–µ–±—É–µ—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

---

## üîß –ò–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

1. **curl** - –¥–ª—è HTTP –∑–∞–ø—Ä–æ—Å–æ–≤
2. **jq** - –¥–ª—è –ø–∞—Ä—Å–∏–Ω–≥–∞ JSON
3. **npm audit** - –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —É—è–∑–≤–∏–º–æ—Å—Ç–µ–π –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π
4. **grep** - –¥–ª—è –ø–æ–∏—Å–∫–∞ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –æ–ø–∞—Å–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –≤ –∫–æ–¥–µ
5. **time** - –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è –≤—Ä–µ–º–µ–Ω–∏ –æ—Ç–≤–µ—Ç–∞ (timing attacks)
6. **base64** - –¥–ª—è –¥–µ–∫–æ–¥–∏—Ä–æ–≤–∞–Ω–∏—è JWT —Ç–æ–∫–µ–Ω–æ–≤

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2025-11-17
