# üõ°Ô∏è –°–≤–æ–¥–∫–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–π —Å–∏—Å—Ç–µ–º—ã –∑–∞—â–∏—Ç—ã –æ—Ç –≤–∑–ª–æ–º–∞

**–î–∞—Ç–∞:** 2025-11-17
**–í–µ—Ä—Å–∏—è:** 1.0

---

## ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### 1. –î–µ—Ç–µ–∫—Ç–æ—Ä –∏–Ω—ä–µ–∫—Ü–∏–π (`InjectionDetectorService`)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ SQL –∏–Ω—ä–µ–∫—Ü–∏–π (20+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ XSS –∞—Ç–∞–∫ (18+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ command injection (20+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤)
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ path traversal (14+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤)
- ‚úÖ –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –¥–ª—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

### 2. –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP (`IpBlockingService`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º–æ–π –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å—é
- ‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–µ–∫—à–∏—Ö –±–ª–æ–∫–∏—Ä–æ–≤–æ–∫
- ‚úÖ –†–∞–∑–Ω—ã–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —É–≥—Ä–æ–∑—ã

### 3. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç–∞ (`AccountSecurityService`)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –ø—Ä–∏ –ø—Ä–µ–≤—ã—à–µ–Ω–∏–∏ –ø–æ—Ä–æ–≥–∞
- ‚úÖ –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã—Ö –∞—Ç–∞–∫ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ IP –∫ –æ–¥–Ω–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É)
- ‚úÖ –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ IP
- ‚úÖ –†–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞
- ‚úÖ –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ email

### 4. –û–±–Ω–∞—Ä—É–∂–µ–Ω–∏–µ —É–≥—Ä–æ–∑ (`ThreatDetectionService`)
- ‚úÖ –ê–Ω–∞–ª–∏–∑ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–∞ –Ω–∞–ª–∏—á–∏–µ —É–≥—Ä–æ–∑
- ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫ –≤—Ö–æ–¥–∞
- ‚úÖ –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### 5. Middleware –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ (`SecurityThreatMiddleware`)
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Å–µ—Ö –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å–∏—Å—Ç–µ–º–æ–π –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏—è —É–≥—Ä–æ–∑

---

## üìä –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö

### –ù–æ–≤—ã–µ –º–æ–¥–µ–ª–∏ Prisma:
1. **IpBlock** - –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP –∞–¥—Ä–µ—Å–æ–≤
2. **AccountSecurityEvent** - —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
3. **AccountSecurityStatus** - —Å—Ç–∞—Ç—É—Å –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∞–∫–∫–∞—É–Ω—Ç–∞
4. **SuspiciousIpActivity** - –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å IP

---

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### –ú–æ–¥—É–ª–∏:
- ‚úÖ `SecurityModule` —Å–æ–∑–¥–∞–Ω –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç –≤—Å–µ —Å–µ—Ä–≤–∏—Å—ã
- ‚úÖ `SecurityModule` –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `AppModule`
- ‚úÖ `SecurityThreatMiddleware` –ø—Ä–∏–º–µ–Ω–µ–Ω –∫–æ –≤—Å–µ–º –º–∞—Ä—à—Ä—É—Ç–∞–º

### –ö–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä—ã:
- ‚úÖ `AuthController` –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω —Å `ThreatDetectionService`
- ‚úÖ –ù–µ—É–¥–∞—á–Ω—ã–µ –ø–æ–ø—ã—Ç–∫–∏ –≤—Ö–æ–¥–∞ –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

---

## üö® –¢–∏–ø—ã –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã—Ö —É–≥—Ä–æ–∑

1. **SQL Injection** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ 24 —á–∞—Å–∞
2. **XSS** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ 6 —á–∞—Å–æ–≤
3. **Command Injection** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ 24 —á–∞—Å–∞
4. **Path Traversal** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ 12 —á–∞—Å–æ–≤
5. **Brute Force** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ IP –Ω–∞ 1 —á–∞—Å, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–∞ 15 –º–∏–Ω—É—Ç
6. **Distributed Attack** ‚Üí –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –≤—Å–µ—Ö IP –Ω–∞ 24 —á–∞—Å–∞, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –∞–∫–∫–∞—É–Ω—Ç–∞ –Ω–∞ 24 —á–∞—Å–∞

---

## üìù –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–í—Å–µ —Å–æ–±—ã—Ç–∏—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤:
- `AccountSecurityEvent` (–ë–î)
- `SuspiciousIpActivity` (–ë–î)
- –õ–æ–≥–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è (console)

---

## ‚öôÔ∏è –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### –ü–æ—Ä–æ–≥–∏ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:
- **Brute Force Threshold**: 5 –Ω–µ—É–¥–∞—á–Ω—ã—Ö –ø–æ–ø—ã—Ç–æ–∫
- **Distributed Attack Threshold**: 3 —Ä–∞–∑–Ω—ã—Ö IP –∫ –æ–¥–Ω–æ–º—É –∞–∫–∫–∞—É–Ω—Ç—É
- **Distributed Attack Window**: 1 —á–∞—Å
- **Account Lock Duration**: 15 –º–∏–Ω—É—Ç (brute force), 24 —á–∞—Å–∞ (distributed attack)

### –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ IP:
- SQL/Command Injection: 24 —á–∞—Å–∞
- XSS: 6 —á–∞—Å–æ–≤
- Path Traversal: 12 —á–∞—Å–æ–≤
- Brute Force: 1 —á–∞—Å
- Distributed Attack: 24 —á–∞—Å–∞

---

## üîß –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. ‚úÖ –°–æ–∑–¥–∞—Ç—å Prisma –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –º–æ–¥–µ–ª–µ–π
2. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å admin endpoints –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞–º–∏
3. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å webhook –¥–ª—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –∞–ª–µ—Ä—Ç–æ–≤
4. ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤
5. ‚ö†Ô∏è –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å (–∏–Ω–¥–µ–∫—Å—ã, –∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ)

---

## üìö –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `SECURITY_SYSTEM_ARCHITECTURE.md` - –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ —Å–∏—Å—Ç–µ–º—ã
- `SECURITY_SYSTEM_SUMMARY.md` - —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω–∞

