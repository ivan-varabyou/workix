# ‚úÖ –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ –∑–∞–≤–µ—Ä—à–µ–Ω: –í—ã–Ω–æ—Å –ø–µ—Ä–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

**–î–∞—Ç–∞**: 2025-01-XX
**–°—Ç–∞—Ç—É—Å**: ‚úÖ **–ó–ê–í–ï–†–®–ï–ù–û**

---

## üìã –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### ‚úÖ –ß–∞—Å—Ç—å 1: Account Lock Service
- –°–æ–∑–¥–∞–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π `AccountLockService`
- –û–±–Ω–æ–≤–ª–µ–Ω—ã `AuthService` –∏ `AdminAuthService`
- –£–±—Ä–∞–Ω–æ –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏

### ‚úÖ –ß–∞—Å—Ç—å 2: Generic JWT Guard
- –°–æ–∑–¥–∞–Ω –±–∞–∑–æ–≤—ã–π `GenericJwtGuard`
- –û–±–Ω–æ–≤–ª–µ–Ω `AdminJwtGuard` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–∞–∑–æ–≤–æ–≥–æ guard
- –û–±—â–∞—è –ª–æ–≥–∏–∫–∞ –∏–∑–≤–ª–µ—á–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤

### ‚úÖ –ß–∞—Å—Ç—å 3: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è ServiceAuthGuard
- –û–±–Ω–æ–≤–ª–µ–Ω `ServiceAuthGuard` –≤ `shared/backend/core`
- –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏–∫–∞—Ç –∏–∑ `api-auth`
- –ï–¥–∏–Ω–∞—è –≤–µ—Ä—Å–∏—è –¥–ª—è –≤—Å–µ—Ö —Å–µ—Ä–≤–∏—Å–æ–≤

### ‚úÖ –ß–∞—Å—Ç—å 4: Session Manager Service
- –°–æ–∑–¥–∞–Ω `SessionManagerService` —Å –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞–º–∏
- –ê–±—Å—Ç—Ä–∞–∫—Ü–∏—è –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Å–µ—Å—Å–∏—è–º–∏
- –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –¥–ª—è users –∏ admins

### ‚úÖ –ß–∞—Å—Ç—å 5: Token Cache Service
- –°–æ–∑–¥–∞–Ω —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π `TokenCacheService`
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –±—ç–∫–µ–Ω–¥—ã: Memory –∏ Redis
- –£–Ω–∏—Ñ–∏—Ü–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤

### ‚úÖ –ß–∞—Å—Ç—å 6: –£–Ω–∏—Ñ–∏–∫–∞—Ü–∏—è Audit Log Service
- –†–∞—Å—à–∏—Ä–µ–Ω `AuditLogService` –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ users –∏ admins
- –î–æ–±–∞–≤–ª–µ–Ω –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å `AuditLogRepository`
- –£–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å –∞—É–¥–∏—Ç–∞

---

## üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã

### –°–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
1. `libs/domain/auth/src/services/account-lock.service.ts`
2. `libs/shared/backend/core/src/guards/generic-jwt.guard.ts`
3. `libs/shared/backend/core/src/services/session-manager.service.ts`
4. `libs/shared/backend/core/src/services/token-cache.service.ts`
5. –†–∞—Å—à–∏—Ä–µ–Ω `libs/domain/auth/src/services/audit-log.service.ts`

### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:
- `libs/domain/auth/src/services/auth.service.ts`
- `libs/domain/admin/src/services/admin-auth.service.ts`
- `libs/domain/admin/src/guards/admin-jwt.guard.ts`
- `libs/shared/backend/core/src/guards/service-auth.guard.ts`
- `apps/api-auth/src/app.module.ts`

### –£–¥–∞–ª–µ–Ω–æ:
- `apps/api-auth/src/auth/guards/service-auth.guard.ts` (–¥—É–±–ª–∏–∫–∞—Ç)

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∏

- ‚úÖ TypeScript –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ `api-auth` —Å–æ–±–∏—Ä–∞–µ—Ç—Å—è —É—Å–ø–µ—à–Ω–æ (`nx run api-auth:build`)
- ‚úÖ –í—Å–µ –º–æ–¥—É–ª–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É—é—Ç –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
- ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

---

## üéØ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

–í—Å–µ —Å–æ–∑–¥–∞–Ω–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≥–æ—Ç–æ–≤—ã –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é –≤:
- ‚úÖ `api-admin` - –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–æ–≤
- ‚úÖ –î—Ä—É–≥–∏—Ö —Å–µ—Ä–≤–∏—Å–∞—Ö –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã Workix
- ‚úÖ –ù–æ–≤—ã—Ö –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–∞—Ö

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

1. **–¢–µ—Å—Ç—ã**: –ï—Å—Ç—å –ø—Ä–æ–±–ª–µ–º–∞ —Å –ø—É—Ç—è–º–∏ –≤ Vitest –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ (–Ω–µ –∫—Ä–∏—Ç–∏—á–Ω–æ, —Å–±–æ—Ä–∫–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç)
2. **–ê–¥–∞–ø—Ç–µ—Ä—ã**: –î–ª—è –ø–æ–ª–Ω–æ–π –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ `SessionManagerService` –∏ `AuditLogService` –≤ `api-admin` –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è —Å–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤
3. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: –í—Å–µ —Å—Ç–∞—Ä—ã–µ –º–µ—Ç–æ–¥—ã —Ä–∞–±–æ—Ç–∞—é—Ç, –∏–∑–º–µ–Ω–µ–Ω–∏—è –Ω–µ –ª–æ–º–∞—é—Ç —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –∫–æ–¥

---

## üöÄ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é Vitest –¥–ª—è —Ç–µ—Å—Ç–æ–≤
2. –°–æ–∑–¥–∞—Ç—å –∞–¥–∞–ø—Ç–µ—Ä—ã —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤ –¥–ª—è `SessionManagerService` –≤ `api-admin`
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –Ω–æ–≤—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –≤ `api-admin`
4. –û–±–Ω–æ–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é

---

**–†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!** üéâ
