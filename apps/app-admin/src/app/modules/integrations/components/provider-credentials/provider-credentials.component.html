<div class="credentials-container">
  <workix-card>
    <div class="credentials-header">
      <h3>Credentials for {{ providerName() }}</h3>
      <div class="header-actions">
        <workix-button
          label="Refresh"
          variant="primary"
          icon="refresh"
          (onClick)="loadCredentials()"
        />
        <workix-button
          label="Add Credential"
          variant="primary"
          icon="add"
          (onClick)="openAddCredentialDialog()"
        />
        <workix-button
          label="Rotate All"
          variant="warn"
          icon="autorenew"
          (onClick)="rotateCredentials()"
        />
      </div>
    </div>

    <div class="credentials-content">
      @if (isLoading()) {
      <div class="loading">
        <workix-spinner [loading]="true" [size]="'md'" />
      </div>
      } @else {
      <workix-data-table [data]="credentials()" [config]="dataTableConfig()" [isLoading]="false" />

      @if (credentials().length === 0) {
      <div class="empty-state">
        <workix-icon name="key_off" [size]="'lg'" />
        <p>No credentials found. Add a credential to get started.</p>
      </div>
      } }
    </div>
  </workix-card>

  <!-- Add Credential Dialog -->
  <workix-form-dialog
    [visible]="showAddCredentialDialog()"
    [config]="addCredentialDialogConfig()"
    [isLoading]="addCredentialLoading()"
    (submit)="onAddCredentialDialogSubmit($event)"
    (cancel)="onAddCredentialDialogCancel()"
    (visibleChange)="showAddCredentialDialog.set($event)"
  />

  <!-- Edit Credential Dialog -->
  <workix-form-dialog
    [visible]="showEditCredentialDialog()"
    [config]="editCredentialDialogConfig()"
    [isLoading]="editCredentialLoading()"
    (submit)="onEditCredentialDialogSubmit($event)"
    (cancel)="onEditCredentialDialogCancel()"
    (visibleChange)="showEditCredentialDialog.set($event)"
  />

  <!-- Delete Credential Dialog -->
  <workix-confirm-dialog
    [visible]="showDeleteCredentialDialog()"
    [config]="deleteCredentialDialogConfig()"
    [isLoading]="deleteCredentialLoading()"
    (confirm)="onDeleteCredentialDialogConfirm()"
    (cancel)="onDeleteCredentialDialogCancel()"
    (visibleChange)="showDeleteCredentialDialog.set($event)"
  />
</div>
